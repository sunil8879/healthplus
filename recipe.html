<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Plus Recipes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    <style>
        :root { --primary: #2a9d8f; --secondary: #264653; }
        body { font-family: 'Poppins', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        
        .search-area { max-width: 600px; margin: 40px auto; position: relative; }
        #recipeInput { 
            width: 100%; padding: 18px 25px; border-radius: 50px; 
            border: none; box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
            font-size: 18px; outline: none; box-sizing: border-box;
        }

        /* The 3-letter prompt box */
        #suggestions {
            position: absolute; width: 100%; background: white; 
            border-radius: 15px; margin-top: 10px; z-index: 2000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); display: none; overflow: hidden;
        }
        .sugg-item { 
            padding: 15px 25px; cursor: pointer; border-bottom: 1px solid #f0f0f0;
            display: flex; align-items: center; gap: 15px; transition: 0.2s;
        }
        .sugg-item:hover { background: #f0fdfa; }
        .sugg-item img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }

        /* Recipe Result Cards */
        #recipeGrid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 25px; max-width: 1100px; margin: 0 auto; 
        }
        .recipe-card { 
            background: white; border-radius: 20px; overflow: hidden; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); position: relative;
        }
        .recipe-card img { width: 100%; height: 220px; object-fit: cover; }
        .card-content { padding: 20px; }
        .card-content h3 { margin: 0 0 10px; color: var(--secondary); font-size: 1.2rem; }
        .nutrition-tag { 
            display: inline-block; background: #eaf6f5; color: var(--primary); 
            padding: 5px 12px; border-radius: 50px; font-size: 12px; font-weight: bold; margin: 2px;
        }
        .btn-view {
            display: block; text-align: center; background: var(--primary);
            color: white; text-decoration: none; padding: 12px;
            margin-top: 15px; border-radius: 10px; font-weight: bold;
        }
    </style>
</head>
<body>

<div style="text-align: center; margin-bottom: 30px;">
    <h1 style="color: var(--secondary);">Indian & Chinese Healthy Kitchen</h1>
    <p>Search for Manchurian, Paneer, Chow Mein, and more...</p>
</div>

<div class="search-area">
    <input type="text" id="recipeInput" placeholder="Type 3 letters (e.g., 'Man')..." autocomplete="off">
    <div id="suggestions"></div>
</div>

<div id="recipeGrid"></div>

<script>
    // --- EDAMAM CONFIG ---
    const APP_ID = "884ba264"; 
    const APP_KEY = "af57106ee9c36a17eada00771635e828";

    const recipeInput = document.getElementById('recipeInput');
    const suggestions = document.getElementById('suggestions');
    const recipeGrid = document.getElementById('recipeGrid');

    let debounceTimer;

    recipeInput.addEventListener('input', () => {
        clearTimeout(debounceTimer);
        const query = recipeInput.value.trim();

        if (query.length >= 3) {
            // Wait 500ms after user stops typing to save API quota
            debounceTimer = setTimeout(() => {
                searchRecipes(query);
            }, 500);
        } else {
            suggestions.style.display = 'none';
        }
    });

    async function searchRecipes(query) {
        try {
            // We search for query + Indian OR Chinese to ensure Manchurian (Indo-Chinese) shows up
            const url = `https://api.edamam.com/search?q=${query}&app_id=${APP_ID}&app_key=${APP_KEY}&from=0&to=6&cuisineType=Indian&cuisineType=Chinese`;
            
            const response = await fetch(url);
            const data = await response.json();

            if (data.hits && data.hits.length > 0) {
                showSuggestions(data.hits);
            }
        } catch (error) {
            console.error("Error fetching recipes:", error);
        }
    }

    function showSuggestions(hits) {
        suggestions.innerHTML = hits.map(item => `
            <div class="sugg-item" onclick="displaySingleRecipe('${btoa(JSON.stringify(item.recipe))}')">
                <img src="${item.recipe.image}">
                <div>
                    <strong>${item.recipe.label}</strong><br>
                    <small style="color: #888;">${Math.round(item.recipe.calories)} Calories</small>
                </div>
            </div>
        `).join('');
        suggestions.style.display = 'block';
    }

    function displaySingleRecipe(encodedData) {
        const recipe = JSON.parse(atob(encodedData));
        suggestions.style.display = 'none';
        recipeInput.value = recipe.label;

        recipeGrid.innerHTML = `
            <div class="recipe-card">
                <img src="${recipe.image}">
                <div class="card-content">
                    <h3>${recipe.label}</h3>
                    <div>
                        <span class="nutrition-tag">Calories: ${Math.round(recipe.calories)}</span>
                        <span class="nutrition-tag">Protein: ${Math.round(recipe.totalNutrients.PROCNT.quantity)}g</span>
                        <span class="nutrition-tag">Carbs: ${Math.round(recipe.totalNutrients.CHOCDF.quantity)}g</span>
                    </div>
                    <p style="font-size: 14px; color: #666; margin-top:10px;">
                        Source: ${recipe.source} <br>
                        Ingredients: ${recipe.ingredientLines.length}
                    </p>
                    <a href="${recipe.url}" target="_blank" class="btn-view">View Full Recipe</a>
                </div>
            </div>
        `;
    }

    // Close suggestions on outside click
    document.addEventListener('click', (e) => {
        if (!recipeInput.contains(e.target)) suggestions.style.display = 'none';
    });
</script>

</body>
</html>